"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[392],{6702(n,e,i){i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"chapters/module-3-simulation/chapter-9-gazebo-setup","title":"Chapter 9 - Gazebo Simulation Setup","description":"Gazebo simulation setup for humanoid robot development","source":"@site/docs/chapters/module-3-simulation/chapter-9-gazebo-setup.md","sourceDirName":"chapters/module-3-simulation","slug":"/chapters/module-3-simulation/chapter-9-gazebo-setup","permalink":"/docs/chapters/module-3-simulation/chapter-9-gazebo-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/RIMZAASAD/Robotic-ai-Book/edit/main/website/docs/chapters/module-3-simulation/chapter-9-gazebo-setup.md","tags":[],"version":"current","frontMatter":{"title":"Chapter 9 - Gazebo Simulation Setup","module":"Digital Twin Simulation","chapter":9,"description":"Gazebo simulation setup for humanoid robot development","learningObjectives":["Install and configure Gazebo for humanoid simulation","Create simulation environments for humanoid robots","Integrate with ROS 2 for control and perception"],"prerequisites":["chapter-8-ros2-tools"],"difficulty":"intermediate"},"sidebar":"textbookSidebar","previous":{"title":"Chapter 8: ROS 2 Tools: Rviz, RQt, TF2","permalink":"/docs/chapters/module-2-ros/chapter-8-ros2-tools"},"next":{"title":"Chapter 10: Physics & Sensor Simulation in Gazebo","permalink":"/docs/chapters/module-3-simulation/chapter-10-physics-sensor-simulation"}}');var t=i(4848),r=i(8453);const a={title:"Chapter 9 - Gazebo Simulation Setup",module:"Digital Twin Simulation",chapter:9,description:"Gazebo simulation setup for humanoid robot development",learningObjectives:["Install and configure Gazebo for humanoid simulation","Create simulation environments for humanoid robots","Integrate with ROS 2 for control and perception"],prerequisites:["chapter-8-ros2-tools"],difficulty:"intermediate"},s=void 0,l={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Gazebo Overview",id:"gazebo-overview",level:2},{value:"Key Components",id:"key-components",level:3},{value:"Installing Gazebo",id:"installing-gazebo",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Installing Gazebo for ROS 2 Humble",id:"installing-gazebo-for-ros-2-humble",level:3},{value:"Alternative: Installing Ignition Gazebo (Garden)",id:"alternative-installing-ignition-gazebo-garden",level:3},{value:"Basic Gazebo Configuration",id:"basic-gazebo-configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Gazebo World Files",id:"gazebo-world-files",level:3},{value:"Integrating Humanoid Robot with Gazebo",id:"integrating-humanoid-robot-with-gazebo",level:2},{value:"URDF to SDF Conversion",id:"urdf-to-sdf-conversion",level:3},{value:"Adding Gazebo Plugins to URDF",id:"adding-gazebo-plugins-to-urdf",level:3},{value:"Physics Configuration for Humanoid Simulation",id:"physics-configuration-for-humanoid-simulation",level:2},{value:"Physics Engine Parameters",id:"physics-engine-parameters",level:3},{value:"Material Properties for Realistic Simulation",id:"material-properties-for-realistic-simulation",level:3},{value:"Control Integration with ROS 2",id:"control-integration-with-ros-2",level:2},{value:"ROS 2 Control Configuration",id:"ros-2-control-configuration",level:3},{value:"Launching with Controllers",id:"launching-with-controllers",level:3},{value:"Vision System Integration",id:"vision-system-integration",level:2},{value:"Camera Configuration for VLA Pipeline",id:"camera-configuration-for-vla-pipeline",level:3},{value:"Simulation Optimization for Humanoid Robots",id:"simulation-optimization-for-humanoid-robots",level:2},{value:"Performance Considerations",id:"performance-considerations",level:3},{value:"Stability Tips for Bipedal Simulation",id:"stability-tips-for-bipedal-simulation",level:3},{value:"Constitution Alignment",id:"constitution-alignment",level:2},{value:"Sim-to-Real Rigor (Principle III)",id:"sim-to-real-rigor-principle-iii",level:3},{value:"Real-Time Validation (Principle IV)",id:"real-time-validation-principle-iv",level:3},{value:"Target Hardware Optimization",id:"target-hardware-optimization",level:3},{value:"Practical Examples",id:"practical-examples",level:2},{value:"Example 1: Humanoid Balance Testing Environment",id:"example-1-humanoid-balance-testing-environment",level:3},{value:"Example 2: ROS 2 Node for Simulation Control",id:"example-2-ros-2-node-for-simulation-control",level:3},{value:"Exercises",id:"exercises",level:2},{value:"Exercise 1: Gazebo Environment Creation",id:"exercise-1-gazebo-environment-creation",level:3},{value:"Exercise 2: Sensor Integration",id:"exercise-2-sensor-integration",level:3},{value:"Exercise 3: Control System Integration",id:"exercise-3-control-system-integration",level:3},{value:"Summary",id:"summary",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Install and configure Gazebo for humanoid simulation"}),"\n",(0,t.jsx)(e.li,{children:"Create simulation environments for humanoid robots"}),"\n",(0,t.jsx)(e.li,{children:"Integrate with ROS 2 for control and perception"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(e.p,{children:'Gazebo provides a high-fidelity physics simulation environment essential for developing and testing humanoid robots before deployment to physical hardware. As part of our "Sim-to-Real Rigor" principle from the project constitution, Gazebo enables training of humanoid robots in virtual environments with realistic physics, sensor simulation, and environmental interactions. This chapter covers the setup and configuration of Gazebo for humanoid robot simulation, with special attention to the physics and sensor simulation requirements that support the Vision-Language-Action pipeline and enable safe testing of bipedal locomotion and dexterous manipulation capabilities.'}),"\n",(0,t.jsx)(e.h2,{id:"gazebo-overview",children:"Gazebo Overview"}),"\n",(0,t.jsx)(e.p,{children:"Gazebo is a 3D simulation environment that provides:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Physics Engine"}),": Realistic simulation of rigid body dynamics"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Sensor Simulation"}),": Cameras, LIDAR, IMUs, force/torque sensors"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Environment Modeling"}),": Complex 3D worlds with realistic lighting"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"ROS Integration"}),": Seamless integration with ROS 2 for control and perception"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"key-components",children:"Key Components"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Gazebo Classic"}),": The traditional Gazebo simulation environment"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Ignition Gazebo"}),": The newer, more modular version (Garden and newer)"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Gazebo GUI"}),": Visual interface for simulation monitoring"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Gazebo Server"}),": Headless simulation backend"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"installing-gazebo",children:"Installing Gazebo"}),"\n",(0,t.jsx)(e.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(e.p,{children:"Before installing Gazebo, ensure ROS 2 is properly installed:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Verify ROS 2 installation\nsource /opt/ros/humble/setup.bash  # Or your ROS 2 distribution\necho $ROS_DISTRO\n"})}),"\n",(0,t.jsx)(e.h3,{id:"installing-gazebo-for-ros-2-humble",children:"Installing Gazebo for ROS 2 Humble"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Install Gazebo with ROS 2 integration\nsudo apt update\nsudo apt install ros-humble-gazebo-ros-pkgs ros-humble-gazebo-plugins\nsudo apt install gazebo\n"})}),"\n",(0,t.jsx)(e.h3,{id:"alternative-installing-ignition-gazebo-garden",children:"Alternative: Installing Ignition Gazebo (Garden)"}),"\n",(0,t.jsx)(e.p,{children:"For the latest features and better performance:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# Add Ignition repository\nsudo curl -sSL https://packages.osrfoundation.org/gazebo.gpg -o /usr/share/keyrings/gazebo-archive-keyring.gpg\necho "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/gazebo-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/gazebo.list > /dev/null\n\nsudo apt update\nsudo apt install ignition-garden\n'})}),"\n",(0,t.jsx)(e.h2,{id:"basic-gazebo-configuration",children:"Basic Gazebo Configuration"}),"\n",(0,t.jsx)(e.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,t.jsx)(e.p,{children:"Set up environment variables for Gazebo:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Add to ~/.bashrc or ~/.zshrc\nexport GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:~/.gazebo/models:~/ros2_ws/src/my_robot_description/models\nexport GAZEBO_RESOURCE_PATH=$GAZEBO_RESOURCE_PATH:~/ros2_ws/src/my_robot_description/worlds\nexport GAZEBO_PLUGIN_PATH=$GAZEBO_PLUGIN_PATH:~/ros2_ws/install/lib\nexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/ros2_ws/install/lib\n"})}),"\n",(0,t.jsx)(e.h3,{id:"gazebo-world-files",children:"Gazebo World Files"}),"\n",(0,t.jsxs)(e.p,{children:["Create a basic world file ",(0,t.jsx)(e.code,{children:"worlds/humanoid_test.world"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.6">\n  <world name="humanoid_test">\n    \x3c!-- Include a default ground plane --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Include a default light source --\x3e\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Add some objects for testing --\x3e\n    <model name="table">\n      <pose>2 0 0.5 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1 0.8 0.8</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1 0.8 0.8</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.6 0.2 1</ambient>\n            <diffuse>0.8 0.6 0.2 1</diffuse>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Add a simple box for manipulation --\x3e\n    <model name="box">\n      <pose>2.2 0.1 0.9 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.1 0.1 0.1</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.1 0.1 0.1</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.2 0.8 0.2 1</ambient>\n            <diffuse>0.2 0.8 0.2 1</diffuse>\n          </material>\n        </visual>\n        <inertial>\n          <mass>0.1</mass>\n          <inertia>\n            <ixx>0.001</ixx>\n            <ixy>0</ixy>\n            <ixz>0</ixz>\n            <iyy>0.001</iyy>\n            <iyz>0</iyz>\n            <izz>0.001</izz>\n          </inertia>\n        </inertial>\n      </link>\n    </model>\n  </world>\n</sdf>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"integrating-humanoid-robot-with-gazebo",children:"Integrating Humanoid Robot with Gazebo"}),"\n",(0,t.jsx)(e.h3,{id:"urdf-to-sdf-conversion",children:"URDF to SDF Conversion"}),"\n",(0,t.jsx)(e.p,{children:"Gazebo can work directly with URDF files through the libgazebo_ros_xacro plugin:"}),"\n",(0,t.jsxs)(e.p,{children:["Create a launch file ",(0,t.jsx)(e.code,{children:"launch/humanoid_gazebo.launch.py"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\n\ndef generate_launch_description():\n    # Launch Gazebo with custom world\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare('gazebo_ros'),\n                'launch',\n                'gazebo.launch.py'\n            ])\n        ]),\n        launch_arguments={\n            'world': PathJoinSubstitution([\n                FindPackageShare('my_robot_description'),\n                'worlds',\n                'humanoid_test.world'\n            ])\n        }.items()\n    )\n\n    # Spawn robot in Gazebo\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'humanoid_robot',\n            '-x', '0', '-y', '0', '-z', '1.0'  # Start 1m above ground for testing\n        ],\n        output='screen'\n    )\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[{\n            'use_sim_time': True,\n            'robot_description': Command([\n                PathJoinSubstitution([FindPackageShare('my_robot_description'), 'urdf', 'humanoid.urdf.xacro'])\n            ])\n        }]\n    )\n\n    return LaunchDescription([\n        gazebo,\n        robot_state_publisher,\n        spawn_entity\n    ])\n"})}),"\n",(0,t.jsx)(e.h3,{id:"adding-gazebo-plugins-to-urdf",children:"Adding Gazebo Plugins to URDF"}),"\n",(0,t.jsx)(e.p,{children:"Enhance your humanoid URDF with Gazebo-specific plugins:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_with_gazebo">\n\n  \x3c!-- Include the basic robot definition --\x3e\n  <xacro:include filename="humanoid.urdf.xacro"/>\n\n  \x3c!-- Gazebo plugins for ROS control --\x3e\n  <gazebo>\n    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">\n      <robotNamespace>/humanoid_robot</robotNamespace>\n      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Gazebo plugins for sensors --\x3e\n  <gazebo reference="camera_link">\n    <sensor type="camera" name="camera_sensor">\n      <always_on>true</always_on>\n      <update_rate>30</update_rate>\n      <camera name="head_camera">\n        <horizontal_fov>1.047</horizontal_fov>  \x3c!-- 60 degrees --\x3e\n        <image>\n          <format>R8G8B8</format>\n          <width>640</width>\n          <height>480</height>\n        </image>\n        <clip>\n          <near>0.1</near>\n          <far>10</far>\n        </clip>\n      </camera>\n      <plugin name="camera_controller" filename="libgazebo_ros_camera.so">\n        <frame_name>camera_link</frame_name>\n        <min_depth>0.1</min_depth>\n        <max_depth>10.0</max_depth>\n      </plugin>\n    </sensor>\n  </gazebo>\n\n  \x3c!-- IMU sensor for balance feedback --\x3e\n  <gazebo reference="torso">\n    <sensor name="imu_sensor" type="imu">\n      <always_on>true</always_on>\n      <update_rate>100</update_rate>  \x3c!-- High rate for balance control --\x3e\n      <imu>\n        <angular_velocity>\n          <x>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>2e-4</stddev>\n            </noise>\n          </x>\n          <y>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>2e-4</stddev>\n            </noise>\n          </y>\n          <z>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>2e-4</stddev>\n            </noise>\n          </z>\n        </angular_velocity>\n        <linear_acceleration>\n          <x>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>1.7e-2</stddev>\n            </noise>\n          </x>\n          <y>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>1.7e-2</stddev>\n            </noise>\n          </y>\n          <z>\n            <noise type="gaussian">\n              <mean>0.0</mean>\n              <stddev>1.7e-2</stddev>\n            </noise>\n          </z>\n        </linear_acceleration>\n      </imu>\n      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">\n        <topicName>imu/data</topicName>\n        <bodyName>torso</bodyName>\n        <updateRateHZ>100.0</updateRateHZ>\n        <gaussianNoise>0.0</gaussianNoise>\n        <frameName>torso</frameName>\n        <initialOrientationAsReference>false</initialOrientationAsReference>\n      </plugin>\n    </sensor>\n  </gazebo>\n\n  \x3c!-- Force/Torque sensor in left foot for balance detection --\x3e\n  <gazebo reference="left_foot">\n    <sensor name="left_foot_ft_sensor" type="force_torque">\n      <always_on>true</always_on>\n      <update_rate>100</update_rate>\n      <force_torque>\n        <frame>child</frame>\n        <measure_direction>child_to_parent</measure_direction>\n      </force_torque>\n      <plugin name="left_foot_ft_plugin" filename="libgazebo_ros_ft_sensor.so">\n        <topicName>left_foot/force_torque</topicName>\n        <frameName>left_foot</frameName>\n      </plugin>\n    </sensor>\n  </gazebo>\n\n  \x3c!-- Joint state publisher for Gazebo --\x3e\n  <gazebo>\n    <plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">\n      <update_rate>30</update_rate>\n      <joint_name>left_hip_joint</joint_name>\n      <joint_name>left_knee_joint</joint_name>\n      <joint_name>left_ankle_joint</joint_name>\n      <joint_name>right_hip_joint</joint_name>\n      <joint_name>right_knee_joint</joint_name>\n      <joint_name>right_ankle_joint</joint_name>\n      <joint_name>left_shoulder_joint</joint_name>\n      <joint_name>left_elbow_joint</joint_name>\n    </plugin>\n  </gazebo>\n\n</robot>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"physics-configuration-for-humanoid-simulation",children:"Physics Configuration for Humanoid Simulation"}),"\n",(0,t.jsx)(e.h3,{id:"physics-engine-parameters",children:"Physics Engine Parameters"}),"\n",(0,t.jsx)(e.p,{children:"Configure physics parameters for realistic humanoid simulation in your world file:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<physics type="ode">\n  <max_step_size>0.001</max_step_size>  \x3c!-- Smaller steps for stability --\x3e\n  <real_time_factor>1.0</real_time_factor>\n  <real_time_update_rate>1000</real_time_update_rate>\n  <gravity>0 0 -9.8</gravity>\n  <ode>\n    <solver>\n      <type>quick</type>\n      <iters>100</iters>  \x3c!-- More iterations for stability --\x3e\n      <sor>1.3</sor>\n    </solver>\n    <constraints>\n      <cfm>0.000001</cfm>\n      <erp>0.2</erp>\n      <contact_max_correcting_vel>100</contact_max_correcting_vel>\n      <contact_surface_layer>0.001</contact_surface_layer>\n    </constraints>\n  </ode>\n</physics>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"material-properties-for-realistic-simulation",children:"Material Properties for Realistic Simulation"}),"\n",(0,t.jsx)(e.p,{children:"Add material properties for realistic contact simulation:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<material name="gazebo/Blue">\n  <ambient>0.0 0.0 0.8 1.0</ambient>\n  <diffuse>0.0 0.0 0.8 1.0</diffuse>\n  <specular>0.0 0.0 0.8 1.0</specular>\n</material>\n\n<material name="gazebo/Red">\n  <ambient>0.8 0.0 0.0 1.0</ambient>\n  <diffuse>0.8 0.0 0.0 1.0</diffuse>\n  <specular>0.8 0.0 0.0 1.0</specular>\n</material>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"control-integration-with-ros-2",children:"Control Integration with ROS 2"}),"\n",(0,t.jsx)(e.h3,{id:"ros-2-control-configuration",children:"ROS 2 Control Configuration"}),"\n",(0,t.jsxs)(e.p,{children:["Create a control configuration file ",(0,t.jsx)(e.code,{children:"config/humanoid_control.yaml"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"controller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    left_leg_controller:\n      type: position_controllers/JointGroupPositionController\n\n    right_leg_controller:\n      type: position_controllers/JointGroupPositionController\n\n    torso_controller:\n      type: position_controllers/JointGroupPositionController\n\nleft_leg_controller:\n  ros__parameters:\n    joints:\n      - left_hip_joint\n      - left_knee_joint\n      - left_ankle_joint\n\nright_leg_controller:\n  ros__parameters:\n    joints:\n      - right_hip_joint\n      - right_knee_joint\n      - right_ankle_joint\n\ntorso_controller:\n  ros__parameters:\n    joints:\n      - neck_joint\n      - left_shoulder_joint\n      - left_elbow_joint\n"})}),"\n",(0,t.jsx)(e.h3,{id:"launching-with-controllers",children:"Launching with Controllers"}),"\n",(0,t.jsx)(e.p,{children:"Update your launch file to include ROS 2 control:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription, RegisterEventHandler\nfrom launch.event_handlers import OnProcessExit\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import PathJoinSubstitution\nfrom launch_ros.actions import Node\nfrom launch_ros.substitutions import FindPackageShare\nfrom launch.substitutions import Command\n\ndef generate_launch_description():\n    # Launch Gazebo with custom world\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            PathJoinSubstitution([\n                FindPackageShare('gazebo_ros'),\n                'launch',\n                'gazebo.launch.py'\n            ])\n        ]),\n        launch_arguments={\n            'world': PathJoinSubstitution([\n                FindPackageShare('my_robot_description'),\n                'worlds',\n                'humanoid_test.world'\n            ])\n        }.items()\n    )\n\n    # Robot state publisher\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[{\n            'use_sim_time': True,\n            'robot_description': Command([\n                'xacro ',\n                PathJoinSubstitution([FindPackageShare('my_robot_description'), 'urdf', 'humanoid_with_gazebo.urdf.xacro'])\n            ])\n        }]\n    )\n\n    # Spawn robot in Gazebo\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'humanoid_robot',\n            '-x', '0', '-y', '0', '-z', '1.0'\n        ],\n        output='screen'\n    )\n\n    # Load controller configurations\n    joint_state_broadcaster_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"joint_state_broadcaster\", \"-c\", \"/controller_manager\"],\n    )\n\n    left_leg_controller_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"left_leg_controller\", \"-c\", \"/controller_manager\"],\n    )\n\n    right_leg_controller_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"right_leg_controller\", \"-c\", \"/controller_manager\"],\n    )\n\n    torso_controller_spawner = Node(\n        package=\"controller_manager\",\n        executable=\"spawner\",\n        arguments=[\"torso_controller\", \"-c\", \"/controller_manager\"],\n    )\n\n    # Create launch description and add actions\n    return LaunchDescription([\n        gazebo,\n        robot_state_publisher,\n        spawn_entity,\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=spawn_entity,\n                on_exit=[joint_state_broadcaster_spawner],\n            )\n        ),\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=joint_state_broadcaster_spawner,\n                on_exit=[left_leg_controller_spawner],\n            )\n        ),\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=left_leg_controller_spawner,\n                on_exit=[right_leg_controller_spawner],\n            )\n        ),\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=right_leg_controller_spawner,\n                on_exit=[torso_controller_spawner],\n            )\n        ),\n    ])\n"})}),"\n",(0,t.jsx)(e.h2,{id:"vision-system-integration",children:"Vision System Integration"}),"\n",(0,t.jsx)(e.h3,{id:"camera-configuration-for-vla-pipeline",children:"Camera Configuration for VLA Pipeline"}),"\n",(0,t.jsx)(e.p,{children:"For the Vision-Language-Action pipeline, configure cameras with appropriate parameters:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="camera_link">\n  <sensor type="depth" name="rgbd_camera">\n    <always_on>true</always_on>\n    <update_rate>30</update_rate>\n    <camera name="head_camera">\n      <horizontal_fov>1.047</horizontal_fov>  \x3c!-- 60 degrees --\x3e\n      <image>\n        <format>R8G8B8</format>\n        <width>640</width>\n        <height>480</height>\n      </image>\n      <clip>\n        <near>0.1</near>\n        <far>10.0</far>\n      </clip>\n      <noise>\n        <type>gaussian</type>\n        <mean>0.0</mean>\n        <stddev>0.007</stddev>\n      </noise>\n    </camera>\n    <plugin name="camera_controller" filename="libgazebo_ros_camera.so">\n      <frame_name>camera_link</frame_name>\n      <min_depth>0.1</min_depth>\n      <max_depth>10.0</max_depth>\n      <update_rate>30.0</update_rate>\n      <hack_baseline>0.07</hack_baseline>\n      <distortion_k1>0.0</distortion_k1>\n      <distortion_k2>0.0</distortion_k2>\n      <distortion_k3>0.0</distortion_k3>\n      <distortion_t1>0.0</distortion_t1>\n      <distortion_t2>0.0</distortion_t2>\n    </plugin>\n  </sensor>\n</gazebo>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"simulation-optimization-for-humanoid-robots",children:"Simulation Optimization for Humanoid Robots"}),"\n",(0,t.jsx)(e.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,t.jsx)(e.p,{children:"For humanoid robots with many degrees of freedom:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Reduce Update Rates"}),": Use appropriate update rates for different sensors"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Simplify Collision Geometry"}),": Use simpler shapes for collision detection"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Limit Physics Steps"}),": Balance accuracy with performance"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"stability-tips-for-bipedal-simulation",children:"Stability Tips for Bipedal Simulation"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Proper Mass Distribution"}),": Ensure realistic inertial properties"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Appropriate Joint Limits"}),": Prevent impossible configurations"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Sufficient Damping"}),": Add damping to prevent oscillations"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Small Time Steps"}),": Use smaller physics steps for stability"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"constitution-alignment",children:"Constitution Alignment"}),"\n",(0,t.jsx)(e.p,{children:"This chapter addresses several constitutional requirements:"}),"\n",(0,t.jsx)(e.h3,{id:"sim-to-real-rigor-principle-iii",children:"Sim-to-Real Rigor (Principle III)"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"High-fidelity physics simulation for realistic humanoid behavior"}),"\n",(0,t.jsx)(e.li,{children:"Proper sensor simulation matching real hardware"}),"\n",(0,t.jsx)(e.li,{children:"Physics parameters tuned for accurate real-world behavior"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"real-time-validation-principle-iv",children:"Real-Time Validation (Principle IV)"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"High update rates for IMU sensors (100Hz) for balance feedback"}),"\n",(0,t.jsx)(e.li,{children:"Proper QoS profiles for real-time sensor data"}),"\n",(0,t.jsx)(e.li,{children:"Performance optimization for real-time simulation"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"target-hardware-optimization",children:"Target Hardware Optimization"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Simulation parameters optimized for deployment to Jetson Orin Nano"}),"\n",(0,t.jsx)(e.li,{children:"Efficient sensor simulation within computational constraints"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,t.jsx)(e.h3,{id:"example-1-humanoid-balance-testing-environment",children:"Example 1: Humanoid Balance Testing Environment"}),"\n",(0,t.jsx)(e.p,{children:"Create a specialized world for balance testing:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.6">\n  <world name="balance_test">\n    \x3c!-- Physics configuration --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n    </physics>\n\n    \x3c!-- Ground plane with texture --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Lighting --\x3e\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Balance testing features --\x3e\n    <model name="narrow_beam">\n      <pose>2 0 0.05 0 0 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>2 0.1 0.1</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>2 0.1 0.1</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.5 0.5 0.5 1</ambient>\n            <diffuse>0.5 0.5 0.5 1</diffuse>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Sloped surface for testing --\x3e\n    <model name="slope">\n      <pose>-2 0 0 0 0.2 0</pose>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1 2 0.2</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.3 0.3 0.7 1</ambient>\n            <diffuse>0.3 0.3 0.7 1</diffuse>\n          </material>\n        </visual>\n      </link>\n    </model>\n  </world>\n</sdf>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"example-2-ros-2-node-for-simulation-control",children:"Example 2: ROS 2 Node for Simulation Control"}),"\n",(0,t.jsx)(e.p,{children:"Create a node to test humanoid control in simulation:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState, Imu\nfrom geometry_msgs.msg import Twist\nfrom std_msgs.msg import Float64MultiArray\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\nimport numpy as np\n\nclass SimulationController(Node):\n    def __init__(self):\n        super().__init__(\'simulation_controller\')\n\n        # QoS profile for simulation (can be best effort)\n        sim_qos = QoSProfile(\n            depth=10,\n            reliability=ReliabilityPolicy.BEST_EFFORT,\n            durability=HistoryPolicy.VOLATILE\n        )\n\n        # Subscriptions\n        self.imu_sub = self.create_subscription(\n            Imu,\n            \'/imu/data\',\n            self.imu_callback,\n            sim_qos\n        )\n\n        self.joint_sub = self.create_subscription(\n            JointState,\n            \'/joint_states\',\n            self.joint_callback,\n            sim_qos\n        )\n\n        # Publishers\n        self.left_leg_pub = self.create_publisher(\n            Float64MultiArray,\n            \'/left_leg_controller/commands\',\n            10\n        )\n\n        self.right_leg_pub = self.create_publisher(\n            Float64MultiArray,\n            \'/right_leg_controller/commands\',\n            10\n        )\n\n        # Balance control timer\n        self.control_timer = self.create_timer(0.01, self.balance_control)  # 100Hz\n\n        # State variables\n        self.current_orientation = None\n        self.current_joint_positions = {}\n\n        self.get_logger().info(\'Simulation controller initialized\')\n\n    def imu_callback(self, msg):\n        """Process IMU data for balance feedback"""\n        self.current_orientation = msg.orientation\n        # Extract roll, pitch, yaw for balance control\n        # Simplified - use proper quaternion to RPY conversion in practice\n\n    def joint_callback(self, msg):\n        """Update current joint positions"""\n        for i, name in enumerate(msg.name):\n            if i < len(msg.position):\n                self.current_joint_positions[name] = msg.position[i]\n\n    def balance_control(self):\n        """Simple balance control algorithm"""\n        if self.current_orientation is None:\n            return\n\n        # Simplified balance control - in practice, use proper control theory\n        # Extract pitch from orientation (simplified)\n        pitch = 2 * (self.current_orientation.z * self.current_orientation.w -\n                     self.current_orientation.x * self.current_orientation.y)\n\n        # Calculate correction based on pitch error\n        correction = -pitch * 10.0  # Proportional control\n\n        # Send commands to legs to maintain balance\n        left_cmd = Float64MultiArray()\n        left_cmd.data = [0.0, 0.0, correction]  # hip, knee, ankle\n\n        right_cmd = Float64MultiArray()\n        right_cmd.data = [0.0, 0.0, correction]  # hip, knee, ankle\n\n        self.left_leg_pub.publish(left_cmd)\n        self.right_leg_pub.publish(right_cmd)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller = SimulationController()\n\n    try:\n        rclpy.spin(controller)\n    except KeyboardInterrupt:\n        controller.get_logger().info(\'Shutting down simulation controller\')\n    finally:\n        controller.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,t.jsx)(e.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsx)(e.h3,{id:"exercise-1-gazebo-environment-creation",children:"Exercise 1: Gazebo Environment Creation"}),"\n",(0,t.jsx)(e.p,{children:"Create a Gazebo world file that includes:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"A humanoid-sized room with furniture"}),"\n",(0,t.jsx)(e.li,{children:"Multiple surfaces with different friction properties"}),"\n",(0,t.jsx)(e.li,{children:"Obstacles for navigation testing"}),"\n",(0,t.jsx)(e.li,{children:"Proper lighting for camera simulation"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"exercise-2-sensor-integration",children:"Exercise 2: Sensor Integration"}),"\n",(0,t.jsx)(e.p,{children:"Enhance your humanoid URDF with:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"RGB-D camera for vision processing"}),"\n",(0,t.jsx)(e.li,{children:"IMU sensors for balance feedback"}),"\n",(0,t.jsx)(e.li,{children:"Force/torque sensors in feet"}),"\n",(0,t.jsx)(e.li,{children:"Proper Gazebo plugins for each sensor"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"exercise-3-control-system-integration",children:"Exercise 3: Control System Integration"}),"\n",(0,t.jsx)(e.p,{children:"Implement a complete simulation setup with:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"ROS 2 control configuration for all humanoid joints"}),"\n",(0,t.jsx)(e.li,{children:"Proper launch files for starting simulation"}),"\n",(0,t.jsx)(e.li,{children:"Balance control node for bipedal stability"}),"\n",(0,t.jsx)(e.li,{children:"Performance optimization for real-time operation"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(e.p,{children:"Gazebo provides the essential simulation environment for developing humanoid robots, enabling safe testing of complex behaviors before deployment to physical hardware. The high-fidelity physics and sensor simulation support the Vision-Language-Action pipeline and enable proper validation of bipedal locomotion and dexterous manipulation capabilities. Understanding Gazebo setup and configuration is crucial for effective humanoid robot development within our Sim-to-Real Rigor framework."}),"\n",(0,t.jsx)(e.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:'"Gazebo Tutorial" - Official Gazebo documentation'}),"\n",(0,t.jsx)(e.li,{children:'"Programming Robots with ROS" by Quigley et al. (Simulation chapter)'}),"\n",(0,t.jsx)(e.li,{children:'"Mastering ROS for Robotics Programming" by Jayanam (Gazebo section)'}),"\n",(0,t.jsx)(e.li,{children:'"Robotics, Vision and Control" by Peter Corke (Simulation chapter)'}),"\n",(0,t.jsx)(e.li,{children:'"Gazebo and ROS Integration Guide" - ROS Wiki'}),"\n"]})]})}function m(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453(n,e,i){i.d(e,{R:()=>a,x:()=>s});var o=i(6540);const t={},r=o.createContext(t);function a(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);