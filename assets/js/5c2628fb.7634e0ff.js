"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[969],{3791(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"chapters/module-2-ros/chapter-6-ros2-packages","title":"Chapter 6 - Creating ROS 2 Packages (Python)","description":"Step-by-step instructions for creating ROS 2 packages in Python","source":"@site/docs/chapters/module-2-ros/chapter-6-ros2-packages.md","sourceDirName":"chapters/module-2-ros","slug":"/chapters/module-2-ros/chapter-6-ros2-packages","permalink":"/docs/chapters/module-2-ros/chapter-6-ros2-packages","draft":false,"unlisted":false,"editUrl":"https://github.com/RIMZAASAD/Robotic-ai-Book/edit/main/website/docs/chapters/module-2-ros/chapter-6-ros2-packages.md","tags":[],"version":"current","frontMatter":{"title":"Chapter 6 - Creating ROS 2 Packages (Python)","module":"ROS 2: The Robotic Nervous System","chapter":6,"description":"Step-by-step instructions for creating ROS 2 packages in Python","learningObjectives":["Create ROS 2 packages using Python","Implement nodes with proper build system configurations","Configure QoS profiles for real-time applications"],"prerequisites":["chapter-5-ros2-architecture"],"difficulty":"intermediate"},"sidebar":"textbookSidebar","previous":{"title":"Chapter 5: ROS 2 Architecture & Core Concepts","permalink":"/docs/chapters/module-2-ros/chapter-5-ros2-architecture"},"next":{"title":"Chapter 7: URDF & XACRO for Humanoid Robots","permalink":"/docs/chapters/module-2-ros/chapter-7-urdf-xacro"}}');var a=r(4848),o=r(8453);const i={title:"Chapter 6 - Creating ROS 2 Packages (Python)",module:"ROS 2: The Robotic Nervous System",chapter:6,description:"Step-by-step instructions for creating ROS 2 packages in Python",learningObjectives:["Create ROS 2 packages using Python","Implement nodes with proper build system configurations","Configure QoS profiles for real-time applications"],prerequisites:["chapter-5-ros2-architecture"],difficulty:"intermediate"},s=void 0,l={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"ROS 2 Package Structure",id:"ros-2-package-structure",level:2},{value:"Creating a Python Package with colcon",id:"creating-a-python-package-with-colcon",level:2},{value:"Step 1: Create the Package Directory",id:"step-1-create-the-package-directory",level:3},{value:"Step 2: Create package.xml",id:"step-2-create-packagexml",level:3},{value:"Step 3: Create setup.py",id:"step-3-create-setuppy",level:3},{value:"Step 4: Create setup.cfg",id:"step-4-create-setupcfg",level:3},{value:"Creating Your First ROS 2 Node",id:"creating-your-first-ros-2-node",level:2},{value:"Step 5: Create the Python Package Directory",id:"step-5-create-the-python-package-directory",level:3},{value:"Step 6: Create a Basic Node",id:"step-6-create-a-basic-node",level:3},{value:"Production-Ready Node with Real-Time Considerations",id:"production-ready-node-with-real-time-considerations",level:2},{value:"Launch Files for Node Management",id:"launch-files-for-node-management",level:2},{value:"Building and Running Your Package",id:"building-and-running-your-package",level:2},{value:"Step 7: Build the Package",id:"step-7-build-the-package",level:3},{value:"Step 8: Run the Package",id:"step-8-run-the-package",level:3},{value:"Testing Your Package",id:"testing-your-package",level:2},{value:"Constitution Alignment",id:"constitution-alignment",level:2},{value:"Production-Ready Code (Key Standard III)",id:"production-ready-code-key-standard-iii",level:3},{value:"Real-Time Validation (Principle IV)",id:"real-time-validation-principle-iv",level:3},{value:"Target Hardware Optimization",id:"target-hardware-optimization",level:3},{value:"Best Practices for Humanoid Robot Packages",id:"best-practices-for-humanoid-robot-packages",level:2},{value:"1. Real-Time Safety",id:"1-real-time-safety",level:3},{value:"2. Modularity",id:"2-modularity",level:3},{value:"3. Resource Management",id:"3-resource-management",level:3},{value:"Practical Examples",id:"practical-examples",level:2},{value:"Example 1: Vision Processing Node",id:"example-1-vision-processing-node",level:3},{value:"Exercises",id:"exercises",level:2},{value:"Exercise 1: Package Creation",id:"exercise-1-package-creation",level:3},{value:"Exercise 2: Parameter Configuration",id:"exercise-2-parameter-configuration",level:3},{value:"Exercise 3: Multi-Node System",id:"exercise-3-multi-node-system",level:3},{value:"Summary",id:"summary",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Create ROS 2 packages using Python"}),"\n",(0,a.jsx)(n.li,{children:"Implement nodes with proper build system configurations"}),"\n",(0,a.jsx)(n.li,{children:"Configure QoS profiles for real-time applications"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsx)(n.p,{children:"Creating ROS 2 packages is fundamental to building modular, reusable robotics software. For Physical AI systems that must operate in real-time with strict timing constraints, proper package structure and configuration are essential. This chapter provides step-by-step instructions for creating ROS 2 packages in Python, with special attention to the production-ready requirements specified in our project constitution, including proper build system configurations (package.xml, setup.py) necessary for deployment on target hardware like the NVIDIA Jetson Orin Nano."}),"\n",(0,a.jsx)(n.h2,{id:"ros-2-package-structure",children:"ROS 2 Package Structure"}),"\n",(0,a.jsx)(n.p,{children:"A standard ROS 2 package follows this directory structure:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"my_robot_package/\n\u251c\u2500\u2500 CMakeLists.txt          # Build configuration for C++\n\u251c\u2500\u2500 package.xml             # Package metadata and dependencies\n\u251c\u2500\u2500 setup.py                # Python package configuration\n\u251c\u2500\u2500 setup.cfg               # Installation configuration\n\u251c\u2500\u2500 resource/               # Resource files\n\u2502   \u2514\u2500\u2500 my_robot_package    # Executable resource links\n\u251c\u2500\u2500 my_robot_package/       # Python source code\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 my_node.py\n\u2502   \u2514\u2500\u2500 my_module.py\n\u2514\u2500\u2500 test/                   # Test files\n    \u2514\u2500\u2500 test_my_node.py\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-python-package-with-colcon",children:"Creating a Python Package with colcon"}),"\n",(0,a.jsx)(n.h3,{id:"step-1-create-the-package-directory",children:"Step 1: Create the Package Directory"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/my_robot_package\ncd ~/ros2_ws/src/my_robot_package\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-2-create-packagexml",children:"Step 2: Create package.xml"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"package.xml"})," file contains metadata about your package:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>my_robot_package</name>\n  <version>0.0.0</version>\n  <description>Example package for humanoid robot control</description>\n  <maintainer email="user@example.com">Your Name</maintainer>\n  <license>Apache-2.0</license>\n\n  <exec_depend>rclpy</exec_depend>\n  <exec_depend>std_msgs</exec_depend>\n  <exec_depend>sensor_msgs</exec_depend>\n  <exec_depend>geometry_msgs</exec_depend>\n  <exec_depend>message_runtime</exec_depend>\n\n  <test_depend>ament_copyright</test_depend>\n  <test_depend>ament_flake8</test_depend>\n  <test_depend>ament_pep257</test_depend>\n  <test_depend>python3-pytest</test_depend>\n\n  <export>\n    <build_type>ament_python</build_type>\n  </export>\n</package>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"step-3-create-setuppy",children:"Step 3: Create setup.py"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"setup.py"})," file configures your Python package:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\nimport os\nfrom glob import glob\n\npackage_name = 'my_robot_package'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n        # Include all launch files\n        (os.path.join('share', package_name, 'launch'), glob('launch/*launch.[pxy][yma]*')),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='user@example.com',\n    description='Example package for humanoid robot control',\n    license='Apache License 2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'my_robot_node = my_robot_package.my_robot_node:main',\n            'balance_controller = my_robot_package.balance_controller:main',\n            'vision_processor = my_robot_package.vision_processor:main',\n        ],\n    },\n)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-4-create-setupcfg",children:"Step 4: Create setup.cfg"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",children:"[develop]\nscript-dir=$base/lib/my_robot_package\n[install]\ninstall-scripts=$base/lib/my_robot_package\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-your-first-ros-2-node",children:"Creating Your First ROS 2 Node"}),"\n",(0,a.jsx)(n.h3,{id:"step-5-create-the-python-package-directory",children:"Step 5: Create the Python Package Directory"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir my_robot_package\ntouch my_robot_package/__init__.py\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-6-create-a-basic-node",children:"Step 6: Create a Basic Node"}),"\n",(0,a.jsxs)(n.p,{children:["Create ",(0,a.jsx)(n.code,{children:"my_robot_package/my_robot_node.py"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom sensor_msgs.msg import JointState\nfrom geometry_msgs.msg import Twist\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy, DurabilityPolicy\n\nclass MyRobotNode(Node):\n    def __init__(self):\n        super().__init__('my_robot_node')\n\n        # Create a publisher for robot status\n        self.status_publisher = self.create_publisher(\n            String,\n            'robot_status',\n            10\n        )\n\n        # Create a subscriber for joint commands\n        # Using QoS profile appropriate for control\n        control_qos = QoSProfile(\n            depth=1,\n            reliability=ReliabilityPolicy.RELIABLE,\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST\n        )\n\n        self.joint_subscriber = self.create_subscription(\n            JointState,\n            'joint_commands',\n            self.joint_callback,\n            control_qos\n        )\n\n        # Timer for periodic status updates\n        self.timer = self.create_timer(1.0, self.timer_callback)\n        self.i = 0\n\n        self.get_logger().info('MyRobotNode has been started')\n\n    def joint_callback(self, msg):\n        self.get_logger().info(f'Received joint positions: {msg.position}')\n        # Process joint commands here\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Robot status: Running for {self.i} seconds'\n        self.status_publisher.publish(msg)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    my_robot_node = MyRobotNode()\n\n    try:\n        rclpy.spin(my_robot_node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        my_robot_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"production-ready-node-with-real-time-considerations",children:"Production-Ready Node with Real-Time Considerations"}),"\n",(0,a.jsx)(n.p,{children:"For humanoid robots requiring real-time performance, nodes must be designed with timing constraints in mind. Here's an example of a balance controller node:"}),"\n",(0,a.jsxs)(n.p,{children:["Create ",(0,a.jsx)(n.code,{children:"my_robot_package/balance_controller.py"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nfrom geometry_msgs.msg import Twist\nfrom std_msgs.msg import Float64MultiArray\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy, DurabilityPolicy\nfrom rclpy.duration import Duration\nimport numpy as np\nfrom collections import deque\n\nclass BalanceController(Node):\n    def __init__(self):\n        super().__init__('balance_controller')\n\n        # Configuration parameters\n        self.declare_parameter('control_frequency', 100)  # 100Hz for balance\n        self.declare_parameter('max_torque', 100.0)\n        self.declare_parameter('balance_kp', 10.0)  # Proportional gain\n        self.declare_parameter('balance_kd', 1.0)   # Derivative gain\n\n        self.control_frequency = self.get_parameter('control_frequency').value\n        self.max_torque = self.get_parameter('max_torque').value\n        self.kp = self.get_parameter('balance_kp').value\n        self.kd = self.get_parameter('balance_kd').value\n\n        # Critical QoS for balance feedback\n        balance_qos = QoSProfile(\n            depth=1,  # Only most recent value matters\n            reliability=ReliabilityPolicy.RELIABLE,  # Must not lose balance data\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST,\n            lifespan=Duration(seconds=0.01)  # 10ms lifespan for balance data\n        )\n\n        # Publishers and subscribers\n        self.imu_sub = self.create_subscription(\n            Imu,\n            '/imu/data',\n            self.imu_callback,\n            balance_qos\n        )\n\n        self.joint_cmd_pub = self.create_publisher(\n            Float64MultiArray,\n            '/joint_group_position_controller/commands',\n            1\n        )\n\n        # Store previous values for derivative calculation\n        self.prev_pitch = 0.0\n        self.prev_time = self.get_clock().now()\n\n        # Initialize timing for control loop\n        control_period = 1.0 / self.control_frequency\n        self.control_timer = self.create_timer(\n            control_period,\n            self.balance_control_loop\n        )\n\n        self.get_logger().info(f'Balance controller started at {self.control_frequency}Hz')\n\n    def imu_callback(self, msg):\n        \"\"\"Process IMU data for balance feedback\"\"\"\n        # Extract pitch angle from IMU orientation\n        # This is simplified - in practice, you'd use proper quaternion math\n        orientation = msg.orientation\n        pitch = self.quaternion_to_pitch(orientation)\n\n        current_time = self.get_clock().now()\n        dt = (current_time - self.prev_time).nanoseconds / 1e9\n\n        # Store values for derivative calculation\n        self.current_pitch = pitch\n        self.dt = dt\n        self.prev_time = current_time\n        self.prev_pitch = pitch\n\n    def quaternion_to_pitch(self, q):\n        \"\"\"Convert quaternion to pitch angle\"\"\"\n        # Simplified conversion - use proper math in production\n        sinr_cosp = 2 * (q.w * q.y - q.z * q.x)\n        cosr_cosp = 1 - 2 * (q.y * q.y + q.x * q.x)\n        pitch = np.arctan2(sinr_cosp, cosr_cosp)\n        return pitch\n\n    def balance_control_loop(self):\n        \"\"\"Main balance control loop running at configured frequency\"\"\"\n        try:\n            # Calculate pitch error (assuming desired pitch is 0)\n            pitch_error = -self.current_pitch  # Negative to correct tilt\n\n            # Calculate derivative for PD control\n            if hasattr(self, 'dt') and self.dt > 0:\n                pitch_rate = (self.current_pitch - self.prev_pitch) / self.dt\n            else:\n                pitch_rate = 0.0\n\n            # PD control law\n            control_output = self.kp * pitch_error - self.kd * pitch_rate\n\n            # Apply torque limits\n            control_output = max(min(control_output, self.max_torque), -self.max_torque)\n\n            # Create joint command message\n            cmd_msg = Float64MultiArray()\n            cmd_msg.data = [control_output]  # Simplified - real system would have multiple joints\n\n            # Publish control command\n            self.joint_cmd_pub.publish(cmd_msg)\n\n            # Log control performance (only occasionally to avoid spam)\n            if hasattr(self, '_log_counter'):\n                self._log_counter += 1\n            else:\n                self._log_counter = 0\n\n            if self._log_counter % 100 == 0:  # Log every 100 iterations\n                self.get_logger().info(\n                    f'Balance: pitch={self.current_pitch:.3f}, '\n                    f'control={control_output:.3f}, '\n                    f'freq={1.0/self.dt:.1f}Hz' if self.dt > 0 else 'freq=N/A'\n                )\n\n        except AttributeError:\n            # Handle case where IMU data hasn't arrived yet\n            pass\n        except Exception as e:\n            self.get_logger().error(f'Balance control error: {e}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    balance_controller = BalanceController()\n\n    try:\n        rclpy.spin(balance_controller)\n    except KeyboardInterrupt:\n        balance_controller.get_logger().info('Balance controller shutting down...')\n    finally:\n        balance_controller.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"launch-files-for-node-management",children:"Launch Files for Node Management"}),"\n",(0,a.jsx)(n.p,{children:"Create a launch directory and launch file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir launch\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Create ",(0,a.jsx)(n.code,{children:"launch/my_robot_launch.py"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='my_robot_package',\n            executable='my_robot_node',\n            name='my_robot_node',\n            output='screen',\n            parameters=[\n                # Add parameters here if needed\n            ]\n        ),\n        Node(\n            package='my_robot_package',\n            executable='balance_controller',\n            name='balance_controller',\n            output='screen',\n            parameters=[\n                {'control_frequency': 100},  # 100Hz for balance\n                {'max_torque': 50.0},\n                {'balance_kp': 15.0},\n                {'balance_kd': 2.0}\n            ]\n        )\n    ])\n"})}),"\n",(0,a.jsx)(n.h2,{id:"building-and-running-your-package",children:"Building and Running Your Package"}),"\n",(0,a.jsx)(n.h3,{id:"step-7-build-the-package",children:"Step 7: Build the Package"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select my_robot_package\nsource install/setup.bash\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-8-run-the-package",children:"Step 8: Run the Package"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Run a single node\nros2 run my_robot_package my_robot_node\n\n# Or run with launch file\nros2 launch my_robot_package my_robot_launch.py\n"})}),"\n",(0,a.jsx)(n.h2,{id:"testing-your-package",children:"Testing Your Package"}),"\n",(0,a.jsxs)(n.p,{children:["Create ",(0,a.jsx)(n.code,{children:"test/test_my_robot_node.py"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import unittest\nimport rclpy\nfrom rclpy.executors import SingleThreadedExecutor\nfrom my_robot_package.my_robot_node import MyRobotNode\n\nclass TestMyRobotNode(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls):\n        rclpy.init()\n\n    @classmethod\n    def tearDownClass(cls):\n        rclpy.shutdown()\n\n    def setUp(self):\n        self.node = MyRobotNode()\n        self.executor = SingleThreadedExecutor()\n        self.executor.add_node(self.node)\n\n    def tearDown(self):\n        self.node.destroy_node()\n\n    def test_node_creation(self):\n        """Test that the node was created successfully"""\n        self.assertIsNotNone(self.node)\n        self.assertEqual(self.node.get_name(), \'my_robot_node\')\n\nif __name__ == \'__main__\':\n    unittest.main()\n'})}),"\n",(0,a.jsx)(n.h2,{id:"constitution-alignment",children:"Constitution Alignment"}),"\n",(0,a.jsx)(n.p,{children:"This chapter addresses several constitutional requirements:"}),"\n",(0,a.jsx)(n.h3,{id:"production-ready-code-key-standard-iii",children:"Production-Ready Code (Key Standard III)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Proper build system configurations (package.xml, setup.py)"}),"\n",(0,a.jsx)(n.li,{children:"Error handling and logging"}),"\n",(0,a.jsx)(n.li,{children:"Parameter configuration for different deployments"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"real-time-validation-principle-iv",children:"Real-Time Validation (Principle IV)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"QoS profile configuration for low-latency control"}),"\n",(0,a.jsx)(n.li,{children:"High-frequency control loops for bipedal balance feedback"}),"\n",(0,a.jsx)(n.li,{children:"Timing considerations for real-time applications"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"target-hardware-optimization",children:"Target Hardware Optimization"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Code optimized for Jetson Orin Nano computational constraints"}),"\n",(0,a.jsx)(n.li,{children:"Efficient memory usage and processing patterns"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"best-practices-for-humanoid-robot-packages",children:"Best Practices for Humanoid Robot Packages"}),"\n",(0,a.jsx)(n.h3,{id:"1-real-time-safety",children:"1. Real-Time Safety"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Use appropriate QoS profiles for safety-critical communications"}),"\n",(0,a.jsx)(n.li,{children:"Implement proper error handling and recovery"}),"\n",(0,a.jsx)(n.li,{children:"Design control loops with known timing characteristics"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"2-modularity",children:"2. Modularity"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Separate concerns into different nodes"}),"\n",(0,a.jsx)(n.li,{children:"Use parameters for configuration"}),"\n",(0,a.jsx)(n.li,{children:"Implement proper interfaces between components"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"3-resource-management",children:"3. Resource Management"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Monitor CPU and memory usage"}),"\n",(0,a.jsx)(n.li,{children:"Implement efficient algorithms for embedded systems"}),"\n",(0,a.jsx)(n.li,{children:"Use appropriate data structures for real-time performance"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,a.jsx)(n.h3,{id:"example-1-vision-processing-node",children:"Example 1: Vision Processing Node"}),"\n",(0,a.jsx)(n.p,{children:"A ROS 2 node for processing camera images:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Image\nfrom cv_bridge import CvBridge\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\nimport cv2\nimport numpy as np\n\nclass VisionProcessor(Node):\n    def __init__(self):\n        super().__init__('vision_processor')\n\n        # Use appropriate QoS for camera data\n        camera_qos = QoSProfile(\n            depth=1,  # Only most recent image matters\n            reliability=ReliabilityPolicy.BEST_EFFORT,  # Can drop frames if needed\n            durability=DurabilityPolicy.VOLATILE,\n            history=HistoryPolicy.KEEP_LAST\n        )\n\n        self.image_sub = self.create_subscription(\n            Image,\n            '/camera/image_raw',\n            self.image_callback,\n            camera_qos\n        )\n\n        self.bridge = CvBridge()\n        self.get_logger().info('Vision processor started')\n\n    def image_callback(self, msg):\n        try:\n            # Convert ROS image to OpenCV\n            cv_image = self.bridge.imgmsg_to_cv2(msg, desired_encoding='bgr8')\n\n            # Process image (example: edge detection)\n            gray = cv2.cvtColor(cv_image, cv2.COLOR_BGR2GRAY)\n            edges = cv2.Canny(gray, 50, 150)\n\n            # Log processing time for performance monitoring\n            self.get_logger().debug('Image processed successfully')\n\n        except Exception as e:\n            self.get_logger().error(f'Image processing error: {e}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    vision_processor = VisionProcessor()\n\n    try:\n        rclpy.spin(vision_processor)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        vision_processor.destroy_node()\n        rclpy.shutdown()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,a.jsx)(n.h3,{id:"exercise-1-package-creation",children:"Exercise 1: Package Creation"}),"\n",(0,a.jsx)(n.p,{children:"Create a ROS 2 package for a humanoid robot's walking controller. Include proper package.xml, setup.py, and a node that implements a simple walking gait with QoS profiles appropriate for locomotion control."}),"\n",(0,a.jsx)(n.h3,{id:"exercise-2-parameter-configuration",children:"Exercise 2: Parameter Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Modify the balance controller node to accept additional parameters for different walking speeds and turning rates. Implement parameter validation to ensure safe operation."}),"\n",(0,a.jsx)(n.h3,{id:"exercise-3-multi-node-system",children:"Exercise 3: Multi-Node System"}),"\n",(0,a.jsx)(n.p,{children:"Design a ROS 2 system with multiple nodes (balance control, vision processing, and high-level planning) that work together for humanoid navigation. Specify the communication patterns and QoS profiles between nodes."}),"\n",(0,a.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(n.p,{children:"Creating ROS 2 packages in Python requires attention to proper build system configurations, QoS profiles for real-time applications, and production-ready code practices. For humanoid robots with strict timing constraints, these considerations are critical for safety and stability. Understanding the package structure and configuration files enables the development of modular, reusable robotics software that can be deployed on target hardware like the NVIDIA Jetson Orin Nano."}),"\n",(0,a.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'"ROS 2 Documentation" - Official ROS 2 tutorials and API documentation'}),"\n",(0,a.jsx)(n.li,{children:'"Programming Robots with ROS" by Quigley et al.'}),"\n",(0,a.jsx)(n.li,{children:'"Effective Robotics Programming with ROS" by Mahtani et al.'}),"\n",(0,a.jsx)(n.li,{children:'"Real-Time Systems and Robotics" for timing-critical applications'}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>i,x:()=>s});var t=r(6540);const a={},o=t.createContext(a);function i(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);